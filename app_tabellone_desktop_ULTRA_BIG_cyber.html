<!doctype html>
<html lang="it">
<head>
<meta charset="utf-8">
<title>Produzione Liquidi • General Copper</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
:root{
 --bg:#02030a;
 --cyan:#35f2ff;
 --mag:#ff2bd6;
 --txt:#f0fbff;
 --muted:#9bb6c8;
}
*{box-sizing:border-box}
html,body{
 margin:0;height:100%;
 background:radial-gradient(circle at top,#0b1f33,#01030a);
 color:var(--txt);
 font-family:Arial, Helvetica, sans-serif;
 overflow:hidden;
}

/* LOADING */
#loading{
 position:fixed; inset:0;
 display:flex; flex-direction:column;
 justify-content:center; align-items:center;
 background:radial-gradient(circle,#0e2a44,#02040a);
 z-index:9999;
}
#loading h1{
 font-size:72px;
 font-weight:900;
 letter-spacing:6px;
 color:var(--cyan);
 text-shadow:0 0 45px var(--cyan);
}
.barwrap{
 width:80%; height:26px;
 border:2px solid rgba(53,242,255,.6);
 margin-top:40px;
}
.bar{
 height:100%; width:0%;
 background:linear-gradient(90deg,var(--cyan),var(--mag));
 box-shadow:0 0 30px var(--cyan);
 transition:width .1s linear;
}
#pct{
 margin-top:18px;
 font-size:26px;
 letter-spacing:2px;
 color:var(--muted);
}

/* APP */
#app{display:none;height:100%;padding:40px;}
header{
 display:flex;justify-content:space-between;align-items:flex-end;
 border-bottom:2px solid rgba(53,242,255,.4);
 padding-bottom:14px;
}
header h2{
 margin:0;
 font-size:56px;
 letter-spacing:6px;
 color:var(--cyan);
}
.times{
 text-align:right;
 font-size:22px;
 color:var(--muted);
}

.main{
 display:grid;
 grid-template-columns:70% 30%;
 height:calc(100% - 120px);
 margin-top:30px;
 gap:30px;
}

.now{
 font-size:120px;
 font-weight:950;
 letter-spacing:3px;
 text-transform:uppercase;
 text-shadow:0 0 40px rgba(53,242,255,.35);
}
.next{
 margin-top:30px;
 font-size:54px;
 font-weight:800;
 color:var(--muted);
}

.list{
 border-left:2px solid rgba(53,242,255,.35);
 padding-left:26px;
 overflow:auto;
}
.item{
 padding:22px 0;
 border-bottom:1px solid rgba(255,255,255,.12);
}
.item strong{
 display:block;
 font-size:38px;
 font-weight:900;
}
.item span{
 font-size:24px;
 color:var(--muted);
}
</style>
</head>

<body>

<div id="loading">
  <h1>AVVIO SISTEMA</h1>
  <div class="barwrap"><div class="bar" id="bar"></div></div>
  <div id="pct">0%</div>
</div>

<div id="app">
  <header>
    <h2>PRODUZIONE LIQUIDI</h2>
    <div class="times">
      <div id="clockIT">--:--</div>
      <div id="clockCN">CN --:--</div>
    </div>
  </header>

  <div class="main">
    <div>
      <div class="now" id="nowProd">—</div>
      <div class="next" id="nextProd">Prossimo: —</div>
    </div>
    <div class="list" id="list"></div>
  </div>
</div>

<script>
const CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vRdbRcMc9ZdrJ0o7jCJZfyCeGuGD3pgxurwbxO6NO_2kizrkg0czCQYR3g0YmUyWffgyBkmBdNe9fiB/pub?output=csv";

let p=0;
const bar=document.getElementById("bar");
const pct=document.getElementById("pct");
const timer=setInterval(()=>{
 p+=2;
 bar.style.width=p+"%";
 pct.textContent=p+"%";
 if(p>=100){
  clearInterval(timer);
  document.getElementById("loading").style.display="none";
  document.getElementById("app").style.display="block";
  init();
 }
},80);

function tick(){
 const d=new Date();
 document.getElementById("clockIT").textContent =
  d.toLocaleTimeString("it-IT",{hour:"2-digit",minute:"2-digit"});
 document.getElementById("clockCN").textContent =
  d.toLocaleTimeString("zh-CN",{timeZone:"Asia/Shanghai",hour:"2-digit",minute:"2-digit"});
}
setInterval(tick,1000);

async function loadCSV(){
 const r=await fetch(CSV_URL+"&t="+Date.now());
 const t=await r.text();
 const rows=t.trim().split("\n").slice(1).map(l=>l.split(","));
 return rows.map(r=>({
  prod:r[0], qty:r[1], fmt:r[3], st:r[4]
 }));
}

async function init(){
 const data=await loadCSV();
 if(!data.length) return;

 document.getElementById("nowProd").textContent="ORA PRODUCI: "+data[0].prod;
 document.getElementById("nextProd").textContent="PROSSIMO: "+(data[1]?.prod||"—");

 const list=document.getElementById("list");
 list.innerHTML="";
 data.forEach(d=>{
  const div=document.createElement("div");
  div.className="item";
  div.innerHTML=`<strong>${d.prod}</strong><span>${d.qty} • ${d.fmt} • ${d.st}</span>`;
  list.appendChild(div);
 });
}
</script>

</body>
</html>
